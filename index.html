<!DOCTYPE html>
<meta charset="utf-8">
<title>SANKEY Experiment</title>
<style>

.node rect {
  cursor: move;
  fill-opacity: .9;
  shape-rendering: crispEdges;
}

.node text {
  pointer-events: none;
  text-shadow: 0 1px 0 #fff;
}

.link {
  fill: none;
  stroke: #000;
  stroke-opacity: .2;
}

.link:hover {
  stroke-opacity: .5;
}

</style>
<body>

<script src="https://d3js.org/d3.v4.min.js"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="sankey_utils.js"></script>
  <script src="d3.layout.cloud.js"></script>
<div class="px-4">
	<div class="row">
		<h3 style = "vertical-align:middle;"> Select Subreddit</h3>
	</div>
	<div class="row">
		<select name="subreddit_filter" id="subreddit_filter" class="selectpicker"></select>
	</div>
    <div class="row">
		<div class="col-6">
			<div id="wordcloud"></div>
            
	    </div>
        <div class="col-6">
		<div id="container-graph"></div>
			
        </div>
	</div>
</div>

</body>


<script src="custom_sankey.js"></script>
<script>
const subreddit_list = ['2meirl4meirl',
'49ers',
'4PanelCringe',
'90DayFiance',
'90dayfianceuncensored',
'ABCDesis',
'ABoringDystopia',
'AFL',
'ATBGE',
'Advice',
'AdviceAnimals',
'AirForce',
'Anarchism',
'Anarcho_Capitalism',
'AnimalsBeingBros',
'AnimalsBeingJerks',
'Anticonsumption',
'Artifact',
'AskALiberal',
'AskFeminists',
'AskMen',
'AskMenOver30',
'AskThe_Donald',
'AskWomen',
'AtlantaHawks',
'Austin',
'BPD',
'BPDlovedones',
'Barca',
'Battlefield',
'BattlefieldV',
'BeautyGuruChatter',
'BetterEveryLoop',
'BigBrother',
'Blackfellas',
'Blackops4',
'Boxing',
'Braves',
'BravoRealHousewives',
'Brawlhalla',
'BreadTube',
'Browns',
'CFB',
'CODZombies',
'COMPLETEANARCHY',
'Calgary',
'CanadaPolitics',
'CapitalismVSocialism',
'Cardinals',
'Catholicism',
'China',
'ChoosingBeggars',
'Christianity',
'CoDCompetitive',
'CollegeBasketball',
'ComedyCemetery',
'CompetitiveForHonor',
'Competitiveoverwatch',
'Connecticut',
'Conservative',
'CryptoCurrency',
'Dallas',
'DanLeBatardShow',
'DeadBedrooms',
'DebateAnAtheist',
'Denver',
'DenverBroncos',
'Detroit',
'DetroitPistons',
'DevilMayCry',
'DiWHY',
'Divorce',
'Documentaries',
'Dodgers',
'DoesAnybodyElse',
'DomesticGirlfriend',
'Drugs',
'DunderMifflin',
'EDAnonymous',
'ENLIGHTENEDCENTRISM',
'Edmonton',
'EdmontonOilers',
'Enough_Sanders_Spam',
'ExpectationVsReality',
'FellowKids',
'FlashTV',
'Flipping',
'ForeverAlone',
'FortniteCompetitive',
'FrankOcean',
'FunnyandSad',
'Futurology',
'GCdebatesQT',
'Games',
'GenderCritical',
'GetMotivated',
'GifRecipes',
'GlobalOffensive',
'GoNets',
'GreenBayPackers',
'Gunners',
'Habs',
'HadToHurt',
'HighQualityGifs',
'HumansBeingBros',
'IASIP',
'IDontWorkHereLady',
'INTP',
'IdiotsInCars',
'IncelTears',
'IncelsWithoutHate',
'InstacartShoppers',
'Instagramreality',
'JUSTNOFAMILY',
'JUSTNOMIL',
'Jokes',
'JordanPeterson',
'Judaism',
'JustNoSO',
'Justfuckmyshitup',
'Kanye',
'KidsAreFuckingStupid',
'KitchenConfidential',
'KotakuInAction',
'LGBTeens',
'LabourUK',
'LateStageCapitalism',
'LetsNotMeet',
'Libertarian',
'LifeProTips',
'LigaMX',
'LosAngeles',
'MLBTheShow',
'MLS',
'MMA',
'MMORPG',
'MakingaMurderer',
'MaliciousCompliance',
'Marriage',
'Mavericks',
'MensRights',
'Military',
'MkeBucks',
'MorbidReality',
'MortalKombat',
'MurderedByWords',
'Music',
'My600lbLife',
'NYGiants',
'NYKnicks',
'NYYankees',
'NarcissisticAbuse',
'NetflixBestOf',
'NewOrleans',
'NewYorkIslanders',
'NewYorkMets',
'NoFap',
'OkCupid',
'OrlandoMagic',
'OttawaSenators',
'OutOfTheLoop',
'Overwatch',
'OverwatchUniversity',
'PUBGXboxOne',
'Padres',
'Paladins',
'PandR',
'Parenting',
'Persona5',
'PoliticalDiscussion',
'PoliticalHumor',
'Portland',
'ProRevenge',
'ProtectAndServe',
'PurplePillDebate',
'QuadrigaCX',
'RWBY',
'RedDeadOnline',
'RedLetterMedia',
'Roadcam',
'RoastMe',
'SSBM',
'SaltLakeCity',
'SandersForPresident',
'Scotland',
'ScottishFootball',
'Seaofthieves',
'SeattleWA',
'SelfAwarewolves',
'ShitPoliticsSays',
'Shitstatistssay',
'Smite',
'SoulCalibur',
'SpoiledDragRace',
'SquaredCircle',
'StLouis',
'StarWarsBattlefront',
'StreetFighter',
'SubredditDrama',
'SubredditSimulator',
'SuicideWatch',
'SweatyPalms',
'TIHI',
'TalesFromRetail',
'TalesFromYourServer',
'Target',
'Teachers',
'TeamSolomid',
'TeenMomOGandTeenMom2',
'Tekken',
'TheSimpsons',
'TheWalkingDeadGame',
'The_Donald',
'The_Mueller',
'Tinder',
'TooAfraidToAsk',
'ToolBand',
'TopMindsOfReddit',
'TownofSalemgame',
'TrollXChromosomes',
'Truckers',
'TrueOffMyChest',
'TrueReddit',
'Trufemcels',
'TwoBestFriendsPlay',
'TwoSentenceHorror',
'TwoXChromosomes',
'Unexpected',
'UpliftingNews',
'VoteBlue',
'WWE',
'WatchPeopleDieInside',
'WayOfTheBern',
'WeWantPlates',
'Wellthatsucks',
'Whatcouldgowrong',
'WhitePeopleTwitter',
'WhyWereTheyFilming',
'WouldYouRather',
'adultery',
'alberta',
'antiMLM',
'antinatalism',
'arrow',
'askcarsales',
'askwomenadvice',
'asoiaf',
'aspergers',
'assassinscreed',
'atheism',
'australia',
'awfuleverything',
'aznidentity',
'badunitedkingdom',
'barstoolsports',
'belgium',
'benzodiazepines',
'bestof',
'bestoflegaladvice',
'bipolar',
'blogsnark',
'bodybuilding',
'breakingmom',
'brexit',
'brisbane',
'britishproblems',
'btc',
'canada',
'canadients',
'canes',
'canucks',
'changemyview',
'chelseafc',
'chicago',
'chicagobulls',
'childfree',
'circlejerk',
'collapse',
'confession',
'confessions',
'conspiracy',
'cringe',
'cringepics',
'dadjokes',
'danganronpa',
'darknet',
'dating',
'dating_advice',
'datingoverthirty',
'dayz',
'deadbydaylight',
'delusionalartists',
'denvernuggets',
'depression',
'detroitlions',
'devils',
'disneyvacation',
'dogswithjobs',
'doordash',
'drunk',
'dxm',
'entertainment',
'entitledparents',
'entp',
'environment',
'ethtrader',
'exchristian',
'exmormon',
'exmuslim',
'facepalm',
'fantasyfootball',
'farcry',
'fatlogic',
'fireemblem',
'forhonor',
'forwardsfromgrandma',
'freefolk',
'funny',
'furry_irl',
'gamegrumps',
'gatekeeping',
'gay',
'gay_irl',
'gaybros',
'gifs',
'goldenknights',
'greysanatomy',
'gunpolitics',
'hawks',
'heroesofthestorm',
'hockey',
'holdmybeer',
'holdmycosmo',
'houston',
'iamverysmart',
'im14andthisisdeep',
'insanepeoplefacebook',
'instant_regret',
'intj',
'ireland',
'islam',
'jobs',
'justneckbeardthings',
'juul',
'korea',
'leafs',
'leagueoflegends',
'legaladvice',
'lewronggeneration',
'lgbt',
'liberalgunowners',
'livepd',
'london',
'lostgeneration',
'lostredditors',
'loveafterlockup',
'masseffect',
'medicine',
'meirl',
'melbourne',
'mentalhealth',
'mildlyinfuriating',
'minnesota',
'minnesotavikings',
'moderatepolitics',
'morbidquestions',
'movies',
'moviescirclejerk',
'muacirclejerk',
'nashville',
'nattyorjuice',
'nba',
'netflix',
'newjersey',
'news',
'newzealand',
'nononono',
'nonononoyes',
'northernireland',
'nottheonion',
'nrl',
'nursing',
'nyc',
'nyjets',
'offmychest',
'oldpeoplefacebook',
'onguardforthee',
'ontario',
'pcgaming',
'penguins',
'perth',
'pettyrevenge',
'philosophy',
'phoenix',
'pics',
'pittsburgh',
'poker',
'politics',
'polyamory',
'popheads',
'popping',
'progun',
'raimimemes',
'raisedbynarcissists',
'rant',
'reactiongifs',
'realmadrid',
'reddeadredemption',
'reddeadredemption2',
'relationship_advice',
'relationships',
'rickandmorty',
'ripcity',
'riverdale',
'rpdrcringe',
'rpghorrorstories',
'rugbyunion',
'rupaulsdragrace',
'sabres',
'sadcringe',
'saltierthancrait',
'samharris',
'sanfrancisco',
'science',
'seduction',
'self',
'sex',
'shieldbro',
'shittyfoodporn',
'slatestarcodex',
'soccer',
'socialanxiety',
'socialism',
'southafrica',
'sports',
'sportsbook',
'starbucks',
'starwarsspeculation',
'steelers',
'sugarlifestyleforum',
'survivinginfidelity',
'sydney',
'syriancivilwar',
'teenagers',
'television',
'tennis',
'terriblefacebookmemes',
'texas',
'thalassophobia',
'thatHappened',
'tifu',
'timberwolves',
'todayilearned',
'toronto',
'torontoraptors',
'traaaaaaannnnnnnnnns',
'trees',
'truegaming',
'uberdrivers',
'ukpolitics',
'unitedkingdom',
'unpopularopinion',
'vancouver',
'vanderpumprules',
'vaxxhappened',
'vegan',
'vegancirclejerk',
'videos',
'walmart',
'washingtondc',
'weed',
'weezer',
'whitepeoplegifs',
'wholesomememes',
'wildhockey',
'winnipegjets',
'woooosh',
'worldnews',
'worldpolitics',
'yesyesyesyesno',
'youseeingthisshit',
'youtube',
'youtubehaiku']

function createDropdown() {
    const select = document.getElementById("subreddit_filter");
    subreddit_list.forEach((d) => {
        const option = document.createElement("option");
        option.text = option.value = d;
        select.add(option);
    })
}
createDropdown();



//Simple animated example of d3-cloud - https://github.com/jasondavies/d3-cloud
//Based on https://github.com/jasondavies/d3-cloud/blob/master/examples/simple.html

// Encapsulate the word cloud functionality
function wordCloud(selector) {

    var fill = d3.scaleOrdinal(d3.schemeCategory10);

    //Construct the word cloud's SVG element
    var svg = d3.select(selector).append("svg")
        .attr("width", 500)
        .attr("height", 500)
        .append("g")
        .attr("transform", "translate(250,250)");
		

	
    //Draw the word cloud
    function draw(words) {
        var cloud = svg.selectAll("g text")
                        .data(words, function(d) { return d.text; })

        //Entering words
        cloud.enter()
            .append("text")
            .style("font-family", "Impact")
            .style("fill", function(d, i) { return fill(i); })
            .attr("text-anchor", "middle")
            .attr('font-size', 1)
            .text(function(d) { return d.text; })
			.on("click", function (d, i){
                document.getElementById("subreddit_filter").value = d.text;
				 SankeyUpdate();
				});

        //Entering and existing words
        cloud
            .transition()
                .duration(600)
                .style("font-size", function(d) { return d.size + "px"; })
                .attr("transform", function(d) {
                    return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                })
                .style("fill-opacity", 1);

        //Exiting words
        cloud.exit()
            .transition()
                .duration(200)
                .style('fill-opacity', 1e-6)
                .attr('font-size', 1)
                .remove();
    }


    //Use the module pattern to encapsulate the visualisation code. We'll
    // expose only the parts that need to be public.
    return {

        //Recompute the word cloud for a new set of words. This method will
        // asycnhronously call draw when the layout has been computed.
        //The outside world will need to call this function, so make it part
        // of the wordCloud return value.
        update: function(words) {
            d3.layout.cloud().size([500, 500])
                .words(words)
                .padding(1)
                //.rotate(function() { return ~~(Math.random() * 2) * 90; })
                .font("Impact")
				.spiral("archimedean")
                .fontSize(function(d) { return d.size; })
                .on("end", draw)
                .start();
        }
    }

}

var words = subreddit_list;

//Prepare one of the sample sentences by removing punctuation,
// creating an array of words and computing a random size attribute.
function getWords() {
    return words.sort(() => .5 - Math.random()).slice(0,200)
            .map(function(d) {
                return {text: d, size: 20};
            })
}

//This method tells the word cloud to redraw with a new set of words.
//In reality the new words would probably come from a server request,
// user input or some other source.

//Create a new instance of the word cloud visualisation.
var myWordCloud = wordCloud('#wordcloud');
console.log(myWordCloud)
showNewWords(myWordCloud);
var timeout_time = 0;
function showNewWords(vis, i) {
    i = i || 0;
	new_words = getWords()
    vis.update(new_words);

	setTimeout(function() { showNewWords(vis, i + 1)}, timeout_time)
	timeout_time = 10000;
}
SankeyUpdate()

</script>
</body>
