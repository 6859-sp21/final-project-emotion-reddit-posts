<!DOCTYPE html>
<meta charset="utf-8">
<title>Subreddit Emotion Analysis</title>
<style>

.topheader {
	background-color: rgb(255,255,255);
	  padding: 10px;
    border-radius: 5px;
	outline-color: rgb(204,204,204);
	outline-width: 2px;
	outline-style: solid;
}

.content {
	background-color: rgb(255,255,255);
	  padding: 10px;
    border-radius: 5px;
	outline-color: rgb(204,204,204);
	outline-width: 2px;
	outline-style: solid;
}

body {
  overflow: hidden; /* Hide scrollbars */
}

.node rect {
  cursor: move;
  fill-opacity: .9;
  shape-rendering: crispEdges;
}

.node text {
  pointer-events: none;
  text-shadow: 0 1px 0 #fff;
}

.link {
  fill: none;
  stroke: #000;
  stroke-opacity: .2;
}

.link:hover {
  stroke-opacity: .5;
}
		.page {
			width: 100vw;
			height: 100vh;
			padding: 40px;
		}

        #chart-gauge {
            width: 400px;
            height: 150px;
            margin: 10px auto  
        } 

        .chart-filled {
            fill: steelblue;
        }
        
        .chart-empty {
            fill: #dedede;
        }
    
        
        .needle, .needle-center {
            fill: #464A4F;
        }

#page1 {
	background-color: rgb(218,224,230);
    background-size: cover;
    background-position: right;
}

#page2 {
	background-color: rgb(218,224,230);
	    background-size: cover;
    background-position: right;
}

#page3 {
	background-color: rgb(218,224,230);
	    background-size: cover;
    background-position: right;
}

#page4 {
	background-color: rgb(218,224,230);
    background-size: cover;
    background-position: left;
}


#CurrentPage {
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    overflow: hidden;
}

#mainPage {
    width: 400vw;
    display: flex;
    margin-left: 0;
    transition: All 0.2s;
}

.arrow {
    border-right:10px solid black;
    border-bottom:10px solid black;
    width:60px;
    height:60px;
    transform: rotate(-45deg);
    margin-top:40px;
}


.leftarrow {
    border-right:10px solid black;
    border-bottom:10px solid black;
    width:60px;
    height:60px;
    transform: rotate(-225deg);
    margin-top:40px;
}

h3 {
  text-align: center;
}

#r-addon {
    background: linear-gradient(
115deg
, #e39a12, #db5909);
    box-shadow: 0 5px 20px -2px rgb(200 50 150 / 70%);
    border: none;
    color: white;
    font-weight: 700;
    padding: 0 0.75rem;
}


</style>
<body>
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
   <!-- Latest compiled and minified CSS -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.min.css">
   <!-- Optional JavaScript -->
   <!-- jQuery first, then Popper.js, then Bootstrap JS -->
   <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
   <!-- Latest compiled and minified JavaScript -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
   <script src="https://d3js.org/d3.v4.min.js"></script>
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
   <script src="sankey_utils.js"></script>
   <script src="d3.layout.cloud.js"></script>
   <div id="mainPage">
      <section id="page1" class="page">
         <div class="row">
            <div class="col-10">
               <div class="d-flex justify-content-center">
                  <img src="reddit_logo.svg" height=100> </img>
               </div>
               <div class="d-flex justify-content-center">
                  <br><br><br><br>
                  <h3>Is the Internet truly toxic? <br> Use this tool to see what emotions really dominate each Subreddit. </h3>
               </div>
               <div class="d-flex justify-content-center">
                  <span id="r-addon" style="line-height: 2em">/r/</span>
                  <select  class="selectpicker" data-width="75%" name="subreddit_filter_main" id="subreddit_filter_main" data-style="btn-warning"></select>
               </div>
            </div>
            <div class="col-2">
               <p>
               <div class="arrow right" id="button2" onClick="toPage(2)" ></div>
               </p>
            </div>
         </div>
         <div class="row">
            <br><br>
            <div class="col-6">
               <br>
               <div id="wordcloud"></div>
            </div>
            <div class="col-4">
               <br><br>
               <div class="d-flex justify-content-center">
                  <script id='reddit_call' src='https://redditjs.com/subreddit.js' data-subreddit='front' data-height='200' data-width='500' data-theme='light'></script> 
               </div>
            </div>
         </div>
         <br><br>
         <div class="row">
            By Felix Dumont and Taylor Facen
         </div>
         <div class="row">
            <a href="https://huggingface.co/datasets/go_emotions"><b>Dataset </b></a> &nbsp;- The GoEmotions dataset contains 58k carefully curated Reddit comments labeled for 27 emotion categories or Neutral. 
         </div>
      </section>
      <section id="page2" class="page">
         <div class="row">
            <div class="col-1">
               <p>
               <div class="leftarrow" id="button2" onClick="toPage(1)" ></div>
               </p>
            </div>
            <div class="col-10">
               <div>
                  <div class="row">
                     <div class = "text-center w-100">
                       <h1>
                         Reddit Communities
                       </h1>
                     </div>
                   </div>
                 <div class="row">
                   <div>
                     <svg id = "network-graph" width="960" height="600"></svg>
                   </div>
                   <script src="https://d3js.org/d3.v4.min.js"></script>
                   <script>
                      var svg = d3.select("#network-graph"),
                        width = +svg.attr("width"),
                        height = +svg.attr("height");

                        var simulation = d3.forceSimulation()
    .force("link", d3.forceLink().id(function(d) { return d.id; }))
    .force("charge", d3.forceManyBody().strength(-400))
    .force("center", d3.forceCenter(width / 2, height / 2));

    function dragstarted(d) {
  if (!d3.event.active) simulation.alphaTarget(0.3).restart()
  simulation.fix(d);
}

function dragged(d) {
  simulation.fix(d, d3.event.x, d3.event.y);
}

function dragended(d) {
  if (!d3.event.active) simulation.alphaTarget(0);
  simulation.unfix(d);
}

d3.json("./network-data.json", function(error, graph) {
  if (error) throw error;
  
  graph.links.forEach(function(d){
    d.source = d.source;    
    d.target = d.target;
  });           

  var link = svg.append("g")
                .style("stroke", "#aaa")
                .selectAll("line")
                .data(graph.links)
                .enter().append("line");

  var node = svg.append("g")
            .attr("class", "nodes")
  .selectAll("circle")
            .data(graph.nodes)
  .enter().append("circle")
          .attr("r", 6)
          .call(d3.drag()
              .on("start", dragstarted)
              .on("drag", dragged)
              .on("end", dragended));
  
  var label = svg.append("g")
      .attr("class", "labels")
      .selectAll("text")
      .data(graph.nodes)
      .enter().append("text")
        .attr("class", "label")
        .text(function(d) { return d.name; });

  simulation
      .nodes(graph.nodes)
      .on("tick", ticked);

  simulation.force("link")
      .links(graph.links);

  function ticked() {
    link
        .attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });

    node
         .attr("r", 20)
         .style("fill", "#d9d9d9")
         .style("stroke", "#969696")
         .style("stroke-width", "1px")
         .attr("cx", function (d) { return d.x+6; })
         .attr("cy", function(d) { return d.y-6; });
    
    label
    		.attr("x", function(d) { return d.x; })
            .attr("y", function (d) { return d.y; })
            .style("font-size", "20px").style("fill", "#4393c3");
  }
});
                   </script>
                 </div>
               </div>
            </div>
            <div class="col-1">
               <p>
               <div class="arrow right" id="button3" onClick="toPage(3)" ></div>
               </p>
            </div>
         </div>
      </section>
      <section id="page3" class="page">
         <div class="row">
            <div class="col-1">
               <p>
               <div class="leftarrow" id="button2" onClick="toPage(2)" ></div>
               </p>
            </div>
            <div class="col-10">
                  <div class="topheader">
                     <div class="row">
                        <div class="col-6">
                           <h2>Dominant Emotions in Reddit Posts  </h2>
                           <b>Change Subreddit</b> &nbsp;&nbsp;
                           <select  class="selectpicker" data-width="75%" name="subreddit_filter" id="subreddit_filter" data-style="btn-warning"></select>
                        </div>
                     </div>
                  </div>
                  <br>
                  <div class="content">
                     <div class="row">
                        <div class="col-8">
                           <div id="container-graph"></div>
                        </div>
                        <div class="col-4">
                           <div id="chart-gauge">
                              <p class = "mb-1 text-center">Average Positivity: <span id = "rating"></span> / 5</p>
                           </div>
                        </div>
                     </div>
                  </div>
            </div>
            <div class="col-1">
               <p>
               <div class="arrow right" id="button3" onClick="toPage(4)" ></div>
               </p>
            </div>
         </div>
      </section>
      <section id="page3" class="page">
         <div class="landingleft">
            <div class="row">
               <div class="col-1">
                  <p>
                  <div class="leftarrow" id="button2" onClick="toPage(3)" ></div>
                  </p>
               </div>
               <div class="col-11">
                  <div>
                     Conclusion
                  </div>
               </div>
            </div>
         </div>
      </section>
   </div>
   </div>
   </section>
</body>


<script src="custom_sankey.js"></script>
<script type="text/javascript" src="d3_gauge.js"></script>
<script type="text/javascript" src="utilities.js"></script>
<script>
		//script = document.getElementById('reddit_call')
		//console.log(document.getElementById('reddit_call'))

		//var script = document.createElement("script");

	//	script.src = "https://redditjs.com/subreddit.js"; 
//		script.setAttribute('data-subreddit', 'mba')
		
		//script.type = "text/javascript";	
	//	script.setAttribute('type', 'text/javascript');
//		document.getElementsByTagName("body")[0].appendChild(script);
		//var elem = document.getElementById("myDIV");			
		//elem`.appendChild(script);
		//script.setAttribute('data-subreddit', 'chess')

const subreddit_list = [
'2meirl4meirl',
'49ers',
'4PanelCringe',
'90DayFiance',
'90dayfianceuncensored',
'ABCDesis',
'ABoringDystopia',
'adultery',
'Advice',
'AdviceAnimals',
'AFL',
'AirForce',
'alberta',
'Anarchism',
'Anarcho_Capitalism',
'AnimalsBeingBros',
'AnimalsBeingJerks',
'Anticonsumption',
'antiMLM',
'antinatalism',
'arrow',
'Artifact',
'AskALiberal',
'askcarsales',
'AskFeminists',
'AskMen',
'AskMenOver30',
'AskThe_Donald',
'AskWomen',
'askwomenadvice',
'asoiaf',
'aspergers',
'assassinscreed',
'ATBGE',
'atheism',
'AtlantaHawks',
'Austin',
'australia',
'awfuleverything',
'aznidentity',
'badunitedkingdom',
'Barca',
'barstoolsports',
'Battlefield',
'BattlefieldV',
'BeautyGuruChatter',
'belgium',
'benzodiazepines',
'bestof',
'bestoflegaladvice',
'BetterEveryLoop',
'BigBrother',
'bipolar',
'Blackfellas',
'Blackops4',
'blogsnark',
'bodybuilding',
'Boxing',
'BPD',
'BPDlovedones',
'Braves',
'BravoRealHousewives',
'Brawlhalla',
'BreadTube',
'breakingmom',
'brexit',
'brisbane',
'britishproblems',
'Browns',
'btc',
'Calgary',
'canada',
'CanadaPolitics',
'canadients',
'canes',
'canucks',
'CapitalismVSocialism',
'Cardinals',
'Catholicism',
'CFB',
'changemyview',
'chelseafc',
'chicago',
'chicagobulls',
'childfree',
'China',
'ChoosingBeggars',
'Christianity',
'circlejerk',
'CoDCompetitive',
'CODZombies',
'collapse',
'CollegeBasketball',
'ComedyCemetery',
'CompetitiveForHonor',
'Competitiveoverwatch',
'COMPLETEANARCHY',
'confession',
'confessions',
'Connecticut',
'Conservative',
'conspiracy',
'cringe',
'cringepics',
'CryptoCurrency',
'dadjokes',
'Dallas',
'danganronpa',
'DanLeBatardShow',
'darknet',
'dating',
'dating_advice',
'datingoverthirty',
'dayz',
'DeadBedrooms',
'deadbydaylight',
'DebateAnAtheist',
'delusionalartists',
'Denver',
'DenverBroncos',
'denvernuggets',
'depression',
'Detroit',
'detroitlions',
'DetroitPistons',
'DevilMayCry',
'devils',
'disneyvacation',
'Divorce',
'DiWHY',
'Documentaries',
'Dodgers',
'DoesAnybodyElse',
'dogswithjobs',
'DomesticGirlfriend',
'doordash',
'Drugs',
'drunk',
'DunderMifflin',
'dxm',
'EDAnonymous',
'Edmonton',
'EdmontonOilers',
'ENLIGHTENEDCENTRISM',
'Enough_Sanders_Spam',
'entertainment',
'entitledparents',
'entp',
'environment',
'ethtrader',
'exchristian',
'exmormon',
'exmuslim',
'ExpectationVsReality',
'facepalm',
'fantasyfootball',
'farcry',
'fatlogic',
'FellowKids',
'fireemblem',
'FlashTV',
'Flipping',
'ForeverAlone',
'forhonor',
'FortniteCompetitive',
'forwardsfromgrandma',
'FrankOcean',
'freefolk',
'funny',
'FunnyandSad',
'furry_irl',
'Futurology',
'gamegrumps',
'Games',
'gatekeeping',
'gay',
'gay_irl',
'gaybros',
'GCdebatesQT',
'GenderCritical',
'GetMotivated',
'GifRecipes',
'gifs',
'GlobalOffensive',
'goldenknights',
'GoNets',
'GreenBayPackers',
'greysanatomy',
'Gunners',
'gunpolitics',
'Habs',
'HadToHurt',
'hawks',
'heroesofthestorm',
'HighQualityGifs',
'hockey',
'holdmybeer',
'holdmycosmo',
'houston',
'HumansBeingBros',
'iamverysmart',
'IASIP',
'IdiotsInCars',
'IDontWorkHereLady',
'im14andthisisdeep',
'IncelsWithoutHate',
'IncelTears',
'insanepeoplefacebook',
'InstacartShoppers',
'Instagramreality',
'instant_regret',
'intj',
'INTP',
'ireland',
'islam',
'jobs',
'Jokes',
'JordanPeterson',
'Judaism',
'Justfuckmyshitup',
'justneckbeardthings',
'JUSTNOFAMILY',
'JUSTNOMIL',
'JustNoSO',
'juul',
'Kanye',
'KidsAreFuckingStupid',
'KitchenConfidential',
'korea',
'KotakuInAction',
'LabourUK',
'LateStageCapitalism',
'leafs',
'leagueoflegends',
'legaladvice',
'LetsNotMeet',
'lewronggeneration',
'lgbt',
'LGBTeens',
'liberalgunowners',
'Libertarian',
'LifeProTips',
'LigaMX',
'livepd',
'london',
'LosAngeles',
'lostgeneration',
'lostredditors',
'loveafterlockup',
'MakingaMurderer',
'MaliciousCompliance',
'Marriage',
'masseffect',
'Mavericks',
'medicine',
'meirl',
'melbourne',
'MensRights',
'mentalhealth',
'mildlyinfuriating',
'Military',
'minnesota',
'minnesotavikings',
'MkeBucks',
'MLBTheShow',
'MLS',
'MMA',
'MMORPG',
'moderatepolitics',
'morbidquestions',
'MorbidReality',
'MortalKombat',
'movies',
'moviescirclejerk',
'muacirclejerk',
'MurderedByWords',
'Music',
'My600lbLife',
'NarcissisticAbuse',
'nashville',
'nattyorjuice',
'nba',
'netflix',
'NetflixBestOf',
'newjersey',
'NewOrleans',
'news',
'NewYorkIslanders',
'NewYorkMets',
'newzealand',
'NoFap',
'nononono',
'nonononoyes',
'northernireland',
'nottheonion',
'nrl',
'nursing',
'nyc',
'NYGiants',
'nyjets',
'NYKnicks',
'NYYankees',
'offmychest',
'OkCupid',
'oldpeoplefacebook',
'onguardforthee',
'ontario',
'OrlandoMagic',
'OttawaSenators',
'OutOfTheLoop',
'Overwatch',
'OverwatchUniversity',
'Padres',
'Paladins',
'PandR',
'Parenting',
'pcgaming',
'penguins',
'Persona5',
'perth',
'pettyrevenge',
'philosophy',
'phoenix',
'pics',
'pittsburgh',
'poker',
'PoliticalDiscussion',
'PoliticalHumor',
'politics',
'polyamory',
'popheads',
'popping',
'Portland',
'progun',
'ProRevenge',
'ProtectAndServe',
'PUBGXboxOne',
'PurplePillDebate',
'QuadrigaCX',
'raimimemes',
'raisedbynarcissists',
'rant',
'reactiongifs',
'realmadrid',
'RedDeadOnline',
'reddeadredemption',
'reddeadredemption2',
'RedLetterMedia',
'relationship_advice',
'relationships',
'rickandmorty',
'ripcity',
'riverdale',
'Roadcam',
'RoastMe',
'rpdrcringe',
'rpghorrorstories',
'rugbyunion',
'rupaulsdragrace',
'RWBY',
'sabres',
'sadcringe',
'saltierthancrait',
'SaltLakeCity',
'samharris',
'SandersForPresident',
'sanfrancisco',
'science',
'Scotland',
'ScottishFootball',
'Seaofthieves',
'SeattleWA',
'seduction',
'self',
'SelfAwarewolves',
'sex',
'shieldbro',
'ShitPoliticsSays',
'Shitstatistssay',
'shittyfoodporn',
'slatestarcodex',
'Smite',
'soccer',
'socialanxiety',
'socialism',
'SoulCalibur',
'southafrica',
'SpoiledDragRace',
'sports',
'sportsbook',
'SquaredCircle',
'SSBM',
'starbucks',
'StarWarsBattlefront',
'starwarsspeculation',
'steelers',
'StLouis',
'StreetFighter',
'SubredditDrama',
'SubredditSimulator',
'sugarlifestyleforum',
'SuicideWatch',
'survivinginfidelity',
'SweatyPalms',
'sydney',
'syriancivilwar',
'TalesFromRetail',
'TalesFromYourServer',
'Target',
'Teachers',
'TeamSolomid',
'teenagers',
'TeenMomOGandTeenMom2',
'Tekken',
'television',
'tennis',
'terriblefacebookmemes',
'texas',
'thalassophobia',
'thatHappened',
'The_Donald',
'The_Mueller',
'TheSimpsons',
'TheWalkingDeadGame',
'tifu',
'TIHI',
'timberwolves',
'Tinder',
'todayilearned',
'TooAfraidToAsk',
'ToolBand',
'TopMindsOfReddit',
'toronto',
'torontoraptors',
'TownofSalemgame',
'traaaaaaannnnnnnnnns',
'trees',
'TrollXChromosomes',
'Truckers',
'truegaming',
'TrueOffMyChest',
'TrueReddit',
'Trufemcels',
'TwoBestFriendsPlay',
'TwoSentenceHorror',
'TwoXChromosomes',
'uberdrivers',
'ukpolitics',
'Unexpected',
'unitedkingdom',
'unpopularopinion',
'UpliftingNews',
'vancouver',
'vanderpumprules',
'vaxxhappened',
'vegan',
'vegancirclejerk',
'videos',
'VoteBlue',
'walmart',
'washingtondc',
'WatchPeopleDieInside',
'WayOfTheBern',
'weed',
'weezer',
'Wellthatsucks',
'WeWantPlates',
'Whatcouldgowrong',
'whitepeoplegifs',
'WhitePeopleTwitter',
'wholesomememes',
'WhyWereTheyFilming',
'wildhockey',
'winnipegjets',
'woooosh',
'worldnews',
'worldpolitics',
'WouldYouRather',
'WWE',
'yesyesyesyesno',
'youseeingthisshit',
'youtube',
'youtubehaiku']

function createDropdown() {
    const select = document.getElementById("subreddit_filter");
    subreddit_list.forEach((d) => {
        const option = document.createElement("option");
        option.text = option.value = d;
        select.add(option);
    })
    const select2 = document.getElementById("subreddit_filter_main");
    subreddit_list.forEach((d) => {
        const option2 = document.createElement("option");
        option2.text = option2.value = d;
        select2.add(option2);
    })
}
createDropdown();
var avgRating = 4.0 // TODO: Implement
needle.defaultRating = avgRating;
document.getElementById("rating").innerText = Math.round(avgRating * 100) / 100;
needle.moveTo(avgRating)

//Simple animated example of d3-cloud - https://github.com/jasondavies/d3-cloud
//Based on https://github.com/jasondavies/d3-cloud/blob/master/examples/simple.html

// Encapsulate the word cloud functionality
function wordCloud(selector) {

    var fill = d3.scaleOrdinal(d3.schemeCategory10);

    //Construct the word cloud's SVG element
    var svg = d3.select(selector).append("svg")
        .attr("width", 700)
        .attr("height", 300)
        .append("g")
        .attr("transform", "translate(350,150)");
		

	
    //Draw the word cloud
    function draw(words) {
        var cloud = svg.selectAll("g text")
                        .data(words, function(d) { return d.text; })

        //Entering words
        cloud.enter()
            .append("text")
            .style("font-family", "Impact")
            .style("fill", function(d, i) { return fill(i); })
            .attr("text-anchor", "middle")
            .attr('font-size', 1)
            .text(function(d) { return d.text; })
			.on("click", function (d, i){
                document.getElementById("subreddit_filter").value = d.text;
								
				$("#subreddit_filter").selectpicker('refresh');
				
				document.getElementById("subreddit_filter_main").value = d.text;
								
				$("#subreddit_filter_main").selectpicker('refresh');
				 SankeyUpdate();
				})
				.on("mouseover", function(d) {		

			
						d3.select(this).style("cursor", "pointer"); 
                   
					})					
				.on("mouseout", function(d) {		
					d3.select(this).style("cursor", "default"); 
				});

        //Entering and existing words
        cloud
            .transition()
                .duration(600)
                .style("font-size", function(d) { return d.size + "px"; })
                .attr("transform", function(d) {
                    return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                })
                .style("fill-opacity", 1);

        //Exiting words
        cloud.exit()
            .transition()
                .duration(200)
                .style('fill-opacity', 1e-6)
                .attr('font-size', 1)
                .remove();
    }


    //Use the module pattern to encapsulate the visualisation code. We'll
    // expose only the parts that need to be public.
    return {

        //Recompute the word cloud for a new set of words. This method will
        // asycnhronously call draw when the layout has been computed.
        //The outside world will need to call this function, so make it part
        // of the wordCloud return value.
        update: function(words) {
            d3.layout.cloud().size([700, 300])
                .words(words)
                .padding(1)
                //.rotate(function() { return ~~(Math.random() * 2) * 90; })
                .font("Impact")
				.spiral("archimedean")
                .fontSize(function(d) { return d.size; })
                .on("end", draw)
                .start();
        }
    }

}

var words = subreddit_list;

//Prepare one of the sample sentences by removing punctuation,
// creating an array of words and computing a random size attribute.
function getWords() {
    return words.sort(() => .5 - Math.random()).slice(0,200)
            .map(function(d) {
                return {text: d, size: 20};
            })
}

//This method tells the word cloud to redraw with a new set of words.
//In reality the new words would probably come from a server request,
// user input or some other source.

//Create a new instance of the word cloud visualisation.
var myWordCloud = wordCloud('#wordcloud');
showNewWords(myWordCloud);
var timeout_time = 0;
function showNewWords(vis, i) {
    i = i || 0;
	new_words = getWords()
    vis.update(new_words);

	setTimeout(function() { showNewWords(vis, i + 1)}, timeout_time)
	timeout_time = 10000;
}
SankeyUpdate()
$("#subreddit_filter").trigger('change');
$("#subreddit_filter").selectpicker('refresh');

$("#subreddit_filter_main").trigger('change');
$("#subreddit_filter_main").selectpicker('refresh');

console.log(myWordCloud);

</script>
</body>
